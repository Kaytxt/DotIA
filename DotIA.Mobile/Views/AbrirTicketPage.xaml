<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="DotIA.Mobile.Views.AbrirTicketPage"
             xmlns:viewmodels="clr-namespace:DotIA.Mobile.ViewModels"
             x:DataType="viewmodels:AbrirTicketViewModel"
             Title="Abrir Ticket Direto"
             BackgroundColor="{StaticResource Background}">

    <Grid RowDefinitions="Auto,*,Auto" Padding="20">

        <!-- Header com informação -->
        <Border Grid.Row="0"
                Padding="15"
                Margin="0,0,0,20"
                StrokeThickness="0">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="{StaticResource Primary}" Offset="0.0" />
                    <GradientStop Color="{StaticResource Secondary}" Offset="1.0" />
                </LinearGradientBrush>
            </Border.Background>
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="15"/>
            </Border.StrokeShape>
            <HorizontalStackLayout Spacing="12">
                <Image Source="icon_ticket.png"
                       HeightRequest="24"
                       WidthRequest="24"
                       VerticalOptions="Center"/>
                <VerticalStackLayout Spacing="5">
                    <Label Text="Precisa de ajuda urgente?"
                           TextColor="White"
                           FontSize="16"
                           FontAttributes="Bold"/>
                    <Label Text="Abra um ticket diretamente com um técnico sem passar pela IA."
                           TextColor="White"
                           FontSize="13"
                           Opacity="0.9"/>
                </VerticalStackLayout>
            </HorizontalStackLayout>
        </Border>

        <!-- Formulário -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="20">

                <!-- Título -->
                <VerticalStackLayout Spacing="8">
                    <HorizontalStackLayout Spacing="8">
                        <Image Source="icon_ticket.png"
                               HeightRequest="18"
                               WidthRequest="18"
                               VerticalOptions="Center"/>
                        <Label Text="Título do Problema"
                               TextColor="White"
                               FontSize="15"
                               FontAttributes="Bold"
                               VerticalOptions="Center"/>
                    </HorizontalStackLayout>
                    <Border BackgroundColor="{StaticResource BackgroundDark}"
                            Stroke="{StaticResource BorderColor}"
                            StrokeThickness="2"
                            Padding="15,12">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15"/>
                        </Border.StrokeShape>
                        <Entry Placeholder="Ex: Problema com impressora"
                               PlaceholderColor="{StaticResource TextMuted}"
                               TextColor="{StaticResource TextSecondary}"
                               Text="{Binding Titulo}"
                               BackgroundColor="Transparent"
                               MaxLength="100"
                               FontSize="15"/>
                    </Border>
                    <Label Text="Dê um título breve e descritivo (mínimo 5 caracteres)"
                           TextColor="{StaticResource TextTertiary}"
                           FontSize="12"/>
                </VerticalStackLayout>

                <!-- Descrição -->
                <VerticalStackLayout Spacing="8">
                    <HorizontalStackLayout Spacing="8">
                        <Image Source="icon_balao.png"
                               HeightRequest="18"
                               WidthRequest="18"
                               VerticalOptions="Center"/>
                        <Label Text="Descrição Detalhada"
                               TextColor="White"
                               FontSize="15"
                               FontAttributes="Bold"
                               VerticalOptions="Center"/>
                    </HorizontalStackLayout>
                    <Border BackgroundColor="{StaticResource BackgroundDark}"
                            Stroke="{StaticResource BorderColor}"
                            StrokeThickness="2"
                            Padding="15,12">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15"/>
                        </Border.StrokeShape>
                        <Editor Placeholder="Descreva seu problema em detalhes...&#x0a;&#x0a;Exemplo:&#x0a;- O que aconteceu?&#x0a;- Quando começou?&#x0a;- Já tentou alguma solução?"
                                PlaceholderColor="{StaticResource TextMuted}"
                                TextColor="{StaticResource TextSecondary}"
                                Text="{Binding Descricao}"
                                BackgroundColor="Transparent"
                                HeightRequest="200"
                                FontSize="15"
                                AutoSize="TextChanges"/>
                    </Border>
                    <Label Text="Quanto mais detalhes, mais rápido o técnico poderá ajudar! (mínimo 20 caracteres)"
                           TextColor="{StaticResource TextTertiary}"
                           FontSize="12"/>
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>

        <!-- Botões -->
        <Grid Grid.Row="2"
              ColumnDefinitions="*,*"
              ColumnSpacing="10"
              Margin="0,20,0,0">

            <!-- Cancelar -->
            <Border Grid.Column="0"
                    BackgroundColor="{StaticResource BackgroundLight}"
                    Stroke="{StaticResource BorderColor}"
                    StrokeThickness="1">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12"/>
                </Border.StrokeShape>
                <Button Text="Cancelar"
                        TextColor="{StaticResource TextSecondary}"
                        BackgroundColor="Transparent"
                        FontSize="16"
                        FontAttributes="Bold"
                        Command="{Binding CancelarCommand}"
                        HeightRequest="50"/>
            </Border>

            <!-- Enviar -->
            <Border Grid.Column="1"
                    StrokeThickness="0">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="{StaticResource Primary}" Offset="0.0" />
                        <GradientStop Color="{StaticResource Secondary}" Offset="1.0" />
                    </LinearGradientBrush>
                </Border.Background>
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12"/>
                </Border.StrokeShape>
                <Button Text="Abrir Ticket"
                        TextColor="White"
                        BackgroundColor="Transparent"
                        FontSize="16"
                        FontAttributes="Bold"
                        Command="{Binding EnviarCommand}"
                        IsEnabled="{Binding IsEnviando, Converter={StaticResource InvertedBoolConverter}}"
                        HeightRequest="50"/>
            </Border>
        </Grid>

    </Grid>
</ContentPage>
